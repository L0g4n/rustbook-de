<!DOCTYPE HTML>
<html lang="de" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Referenzen und Ausleihen | Die Programmiersprache Rust</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.4.2">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-anchors/plugin.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
    

        
    
    
    <link rel="next" href="../book/Lebensdauer.html" />
    
    
    <link rel="prev" href="../book/Besitz.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="4.8" data-basepath=".." data-revision="Mon Nov 02 2015 15:15:21 GMT+0100 (CET)">
    

<div class="book-summary">
    <div class="book-search" role="search">
        <input type="text" placeholder="Suchbegriff eingeben" class="form-control" />
    </div>
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Einführung
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="book/Erste_Schritte.html">
            
                
                    <a href="../book/Erste_Schritte.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Erste Schritte
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="book/Rust_Installieren.html">
            
                
                    <a href="../book/Rust_Installieren.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Rust installieren
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="book/Hallo_Welt.html">
            
                
                    <a href="../book/Hallo_Welt.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Hallo Welt
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="book/Hallo_Cargo.html">
            
                
                    <a href="../book/Hallo_Cargo.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        Hallo Cargo
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="book/Lerne_Rust.html">
            
                
                    <a href="../book/Lerne_Rust.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Lerne Rust
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="book/Ratespiel.html">
            
                
                    <a href="../book/Ratespiel.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Ratespiel
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="book/Speisende_Philosophen.html">
            
            <span><b>2.2.</b> Speisende Philosophen</span>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="book/Rust_In_Anderen_Sprachen.html">
            
            <span><b>2.3.</b> Rust in anderen Sprachen</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="book/Effektives_Rust.html">
            
                
                    <a href="../book/Effektives_Rust.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Effektives Rust
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="book/Der_Stack_Und_Der_Heap.html">
            
                
                    <a href="../book/Der_Stack_Und_Der_Heap.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Der Stack und der Heap
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="book/Testen.html">
            
                
                    <a href="../book/Testen.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Testen
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="book/Bedingte_Kompilierung.html">
            
                
                    <a href="../book/Bedingte_Kompilierung.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Bedingte Kompilierung
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="book/Dokumentation.html">
            
                
                    <a href="../book/Dokumentation.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        Dokumentation
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="book/Iteratoren.html">
            
                
                    <a href="../book/Iteratoren.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        Iteratoren
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="book/Nebenläufigkeit.html">
            
                
                    <a href="../book/Nebenläufigkeit.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        Nebenläufigkeit
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="book/Fehlerbehandlung.html">
            
            <span><b>3.7.</b> Fehlerbehandlung</span>
            
            
        </li>
    
        <li class="chapter " data-level="3.8" data-path="book/Garantien_Wählen.html">
            
            <span><b>3.8.</b> Garantien Wählen</span>
            
            
        </li>
    
        <li class="chapter " data-level="3.9" data-path="book/FFI.html">
            
            <span><b>3.9.</b> FFI</span>
            
            
        </li>
    
        <li class="chapter " data-level="3.10" data-path="book/Borrow_Und_AsRef.html">
            
            <span><b>3.10.</b> Borrow und AsRef</span>
            
            
        </li>
    
        <li class="chapter " data-level="3.11" data-path="book/Release_Kanäle.html">
            
            <span><b>3.11.</b> Release Kanäle</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="book/Syntax_Und_Semantik.html">
            
                
                    <a href="../book/Syntax_Und_Semantik.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Syntax und Semantik
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="book/Variablenbindung.html">
            
                
                    <a href="../book/Variablenbindung.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Variablenbindung
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="book/Funktionen.html">
            
                
                    <a href="../book/Funktionen.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Funktionen
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="book/Primitive_Typen.html">
            
                
                    <a href="../book/Primitive_Typen.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        Primitive Typen
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="book/Kommentare.html">
            
                
                    <a href="../book/Kommentare.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                        Kommentare
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="book/If.html">
            
                
                    <a href="../book/If.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                        if
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="book/Schleifen.html">
            
                
                    <a href="../book/Schleifen.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.</b>
                        
                        Schleifen
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="book/Besitz.html">
            
                
                    <a href="../book/Besitz.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.7.</b>
                        
                        Besitz
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="4.8" data-path="book/Referenzen_Und_Ausleihen.html">
            
                
                    <a href="../book/Referenzen_Und_Ausleihen.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.8.</b>
                        
                        Referenzen und Ausleihen
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.9" data-path="book/Lebensdauer.html">
            
                
                    <a href="../book/Lebensdauer.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.</b>
                        
                        Lebensdauer
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.10" data-path="book/Veränderbarkeit.html">
            
            <span><b>4.10.</b> Veränderbarkeit</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.11" data-path="book/Structs.html">
            
                
                    <a href="../book/Structs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.11.</b>
                        
                        Structs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.12" data-path="book/Enums.html">
            
            <span><b>4.12.</b> Enums</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.13" data-path="book/Match.html">
            
            <span><b>4.13.</b> Match</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.14" data-path="book/Muster.html">
            
            <span><b>4.14.</b> Muster</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.15" data-path="book/Methodensyntax.html">
            
            <span><b>4.15.</b> Methodensyntax</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.16" data-path="book/Vektoren.html">
            
            <span><b>4.16.</b> Vektoren</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.17" data-path="book/Strings.html">
            
            <span><b>4.17.</b> Strings</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.18" data-path="book/Generics.html">
            
            <span><b>4.18.</b> Generics</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.19" data-path="book/Traits.html">
            
            <span><b>4.19.</b> Traits</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.20" data-path="book/Drop.html">
            
            <span><b>4.20.</b> Drop</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.21" data-path="book/If_Let.html">
            
            <span><b>4.21.</b> if let</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.22" data-path="book/Trait_Objekte.html">
            
            <span><b>4.22.</b> Trait Objekte</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.23" data-path="book/Closures.html">
            
            <span><b>4.23.</b> Closures</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.24" data-path="book/UFCS.html">
            
            <span><b>4.24.</b> Universal Function Call Syntax</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.25" data-path="book/Crates_Und_Module.html">
            
            <span><b>4.25.</b> Crates und Module</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.26" data-path="book/Const_Und_Static.html">
            
            <span><b>4.26.</b> `const` und `static`</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.27" data-path="book/Attribute.html">
            
            <span><b>4.27.</b> Attribute</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.28" data-path="book/Type_Aliase.html">
            
            <span><b>4.28.</b> `type` Aliase</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.29" data-path="book/Zwischen_Typen_Umwandeln.html">
            
            <span><b>4.29.</b> Zwischen typen umwandeln</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.30" data-path="book/Assoziierte_Typen.html">
            
            <span><b>4.30.</b> Assoziierte Typen</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.31" data-path="book/Größenlose_Typen.html">
            
            <span><b>4.31.</b> Größenlose Typen</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.32" data-path="book/Operatoren_Und_Überladen.html">
            
            <span><b>4.32.</b> Operatoren und Überladen</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.33" data-path="book/Deref_Umwandlung.html">
            
            <span><b>4.33.</b> Deref Umwandlung</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.34" data-path="book/Makros.html">
            
            <span><b>4.34.</b> Makros</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.35" data-path="book/Raw_Zeiger.html">
            
            <span><b>4.35.</b> Raw Zeiger</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.36" data-path="book/Unsafe.html">
            
            <span><b>4.36.</b> `unsafe`</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="book/Nightly_Rust.html">
            
            <span><b>5.</b> Nightly Rust</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="book/Compiler_Plugins.html">
            
            <span><b>5.1.</b> Compiler Plugins</span>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="book/Inline_Assembly.html">
            
            <span><b>5.2.</b> Inline Assembly</span>
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="book/No_Stdlib.html">
            
            <span><b>5.3.</b> `no_stdlib`</span>
            
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="book/Intrinsics.html">
            
            <span><b>5.4.</b> Intrinsics</span>
            
            
        </li>
    
        <li class="chapter " data-level="5.5" data-path="book/Lang_Items.html">
            
            <span><b>5.5.</b> Lang items</span>
            
            
        </li>
    
        <li class="chapter " data-level="5.6" data-path="book/Fortgeschrittenes_Linken.html">
            
            <span><b>5.6.</b> Fortgeschrittenes Linken</span>
            
            
        </li>
    
        <li class="chapter " data-level="5.7" data-path="book/Benchmark_Tests.html">
            
            <span><b>5.7.</b> Benchmark Tests</span>
            
            
        </li>
    
        <li class="chapter " data-level="5.8" data-path="book/Box_Syntax_Und_Muster.html">
            
            <span><b>5.8.</b> Box Syntax und Muster</span>
            
            
        </li>
    
        <li class="chapter " data-level="5.9" data-path="book/Slice_Muster.html">
            
            <span><b>5.9.</b> Slice Muster</span>
            
            
        </li>
    
        <li class="chapter " data-level="5.10" data-path="book/Assoziierte_Konstanten.html">
            
            <span><b>5.10.</b> Assoziierte Konstanten</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="book/Glossar.html">
            
            <span><b>6.</b> Glossar</span>
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="book/Akademische_Forschung.html">
            
            <span><b>7.</b> Akademische Forschung</span>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Veröffentlicht mit GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Inhaltsverzeichnis"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Suche"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Schrifteinstellungen"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">Hell</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Nacht</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Teilen"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Auf Twitter teilen
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Auf Google teilen
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Auf Facebook teilen
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Auf Weibo teilen
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Auf Instapaper teilen
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Die Programmiersprache Rust</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="referenzen-und-ausleihen"><a name="referenzen-und-ausleihen" class="plugin-anchor" href="#referenzen-und-ausleihen"><span class="fa fa-link"></span></a>Referenzen und Ausleihen</h1>
<p>Dieser Guide ist einer von dreien, der Rusts Ownership-System.
pr&#xE4;sentiert. Dies ist eines von Rusts einzigartigen und verlockenden
Features mit denen Rust Entwickler vertraut sein sollten.
Durch Ownership [engl.: Besitz] erreicht Rust sein gr&#xF6;&#xDF;tes Ziel,
die Speichersicherheit.
Es gibt ein paar verschiedene Konzepte, jedes mit seinem eigenen Kapitel:</p>
<ul>
<li><a href="Besitz.html">Besitz</a>, das Schl&#xFC;sselkonzept.</li>
<li>Ausleihen, das was du gerade liest.</li>
<li><a href="Lebensdauer.html">Lebensdauer</a>, ein fortgeschrittenes Konzept des Ausleihens.</li>
</ul>
<p>Diese drei Kapitel sind verwandt und deswegen in dieser Reihenfolge zu lesen.
Du wirst alle drei ben&#xF6;tigen um das Ownership-System vollst&#xE4;ndig zu verstehen.</p>
<h1 id="meta"><a name="meta" class="plugin-anchor" href="#meta"><span class="fa fa-link"></span></a>Meta</h1>
<p>Bevor wir in die Details gehen gibt es zwei wichtige Hinweise &#xFC;ber das
Ownership-System.</p>
<p>Rust hat einen Fokus auf Sicherheit und Geschwindigkeit.
Es erf&#xFC;llt diese Ziele durch viele &quot;kostenfreie Abstraktionen&quot;
[&#x2018;zero-cost abstractions&#x2019;], was bedeutet, dass in Rust die Kosten so niedrig
wie m&#xF6;glich sind um diese Abstraktionen funktionieren zu lassen.
Jegliche Analyse &#xFC;ber die wie in diesem Guide sprechen wird
<em>zur Kompilierzeit</em> ausgef&#xFC;hrt. Du zahlst f&#xFC;r diese Features
keine Extrakosten zur Laufzeit.</p>
<p>Jedoch hat dieses System einen gewissen Preis: Die Lernkurve.
Viele neue Rust Nutzer erleben etwas,
was wir &quot;mit dem <em>borrow checker</em> k&#xE4;mpfen&quot; nennen,
wobei dann Rust verweigert ein Programm zu kompilieren,
bei dem der Author denkt, dass es korrekt ist.
Das passiert h&#xE4;ufig, da das mentale Modell des Programmierers von Ownership
nicht den eigentlichen Regeln entspricht, die Rust implementiert.
Du wirst wahrscheinlich zuerst etwas &#xE4;hnliches erleben.
Die guten Nachricht ist aber:
Erfahrenere Rust Entwickler berichten, dass, sobald sie eine Zeit
mit den Regeln des Ownership-Systems gearbeitet haben, sie immer weniger
mit dem <em>borrow checker</em> k&#xE4;mpfen m&#xFC;ssen. </p>
<p>Mit diesem Wissen, lass uns &#xFC;ber Ausleihen lernen.</p>
<h1 id="ausleihen"><a name="ausleihen" class="plugin-anchor" href="#ausleihen"><span class="fa fa-link"></span></a>Ausleihen</h1>
<p>Am ende des <a href="Besitz.html">Besitz</a> Abschnittes hatten wir eine &#xFC;ble Funktion,
die so aussah:</p>
<pre><code class="lang-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">foo</span></span>(v1: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">i32</span>&gt;, v2: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">i32</span>&gt;) -&gt; (<span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">i32</span>&gt;, <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">i32</span>&gt;, <span class="hljs-keyword">i32</span>) {
    <span class="hljs-comment">// do stuff with v1 and v2</span>

    <span class="hljs-comment">// hand back ownership, and the result of our function</span>
    (v1, v2, <span class="hljs-number">42</span>)
}

<span class="hljs-keyword">let</span> v1 = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">let</span> v2 = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];

<span class="hljs-keyword">let</span> (v1, v2, answer) = foo(v1, v2);
</code></pre>
<p>Das ist jedoch kein &#xFC;bliches Rust,
da wir das &quot;Ausleihen&quot; [borrowing] nicht verwenden.
Hier ist unser erster Schritt:</p>
<pre><code class="lang-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">foo</span></span>(v1: &amp;<span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">i32</span>&gt;, v2: &amp;<span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">i32</span>&gt;) -&gt; <span class="hljs-keyword">i32</span> {
    <span class="hljs-comment">// do stuff with v1 and v2</span>

    <span class="hljs-comment">// return the answer</span>
    <span class="hljs-number">42</span>
}

<span class="hljs-keyword">let</span> v1 = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">let</span> v2 = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];

<span class="hljs-keyword">let</span> answer = foo(&amp;v1, &amp;v2);

<span class="hljs-comment">// we can use v1 and v2 here!</span>
</code></pre>
<p>Anstatt der <code>Vec&lt;i32&gt;</code> verwenden wir Referenzen als Argument:
<code>&amp;Vec&lt;i32&gt;</code>. Und anstatt <code>v1</code> und <code>v2</code> &#xFC;bergeben wir <code>&amp;v1</code> und <code>&amp;v2</code>.
Wir nennen den <code>&amp;T</code> eine &#x2018;Referenz&#x2019; und anstatt die Ressource zu besitzen,
leihen sie sich die Ressource aus.
Eine Bindung, die sich etwas ausleiht, gibt den Speicher der Ressource nicht
frei, wenn sie den Scope verl&#xE4;sst. Das bedeutet, dass wir nach dem Aufruf
<code>foo()</code> unsere urspr&#xFC;ngliche Bindung wieder verwenden k&#xF6;nnne.</p>
<p>Referenzen sind unver&#xE4;nderbar [immutable], genauso wie Bindungen.
Das bedeutet, dass der Vektor innerhalb von <code>foo()</code> nicht ver&#xE4;ndert werden kann:</p>
<pre><code class="lang-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">foo</span></span>(v: &amp;<span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">i32</span>&gt;) {
     v.push(<span class="hljs-number">5</span>);
}

<span class="hljs-keyword">let</span> v = <span class="hljs-built_in">vec!</span>[];

foo(&amp;v);
</code></pre>
<p>Dies erzeugt einen Fehler:</p>
<pre><code class="lang-text">error: cannot borrow immutable borrowed content `*v` as mutable
v.push(5);
^
</code></pre>
<p>Eine neue Variable am ende des Vektors anzuf&#xFC;gen ver&#xE4;ndert den Vektor,
also d&#xFC;rfen wir das nicht machen.</p>
<h1 id="-mut-referenzen"><a name="-mut-referenzen" class="plugin-anchor" href="#-mut-referenzen"><span class="fa fa-link"></span></a>&amp;mut Referenzen</h1>
<p>Es gibt eine zweite Art von Referenz: <code>&amp;mut T</code>.
Eine ver&#xE4;nderbare Referenz [mutable reference] erlaubt einem
die Ressource, die man ausleiht, zu ver&#xE4;ndern. Zum Beispiel:</p>
<pre><code class="lang-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> x = <span class="hljs-number">5</span>;
{
    <span class="hljs-keyword">let</span> y = &amp;<span class="hljs-keyword">mut</span> x;
    *y += <span class="hljs-number">1</span>;
}
<span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;{}&quot;</span>, x);
</code></pre>
<p>Dies wird <code>6</code> ausgeben. Wir machen <code>y</code> zu einer ver&#xE4;nderbaren Referenz auf
<code>x</code> und inkrementieren dann den Wert auf den <code>y</code> zeigt.
Du wirst bemerken, dass <code>x</code> ebenfalls als <code>mut</code> markiert werden musste.
Wenn es das nicht w&#xE4;re, dann k&#xF6;nnten wir keine ver&#xE4;nderbare Referenz darauf
erzeugen.</p>
<p>Du wirst auch feststellen, dass wir ein Stern (<code>*</code>) vor dem <code>y</code> hinzugef&#xFC;gt
haben: <code>*y</code>. Das ist so, weil <code>y</code> eine <code>&amp;mut</code> Referenz ist.
Du wirst den Stern auch brauchen, wenn du auf den Inhalt einer normalen
Referenz zugreifen m&#xF6;chtest.</p>
<p>Ansonsten sind <code>&amp;mut</code> Referenzen genauso wie die gew&#xF6;hnlichen Referenzen.
Es <em>gibt</em> jedoch einen gro&#xDF;en Unterschied zwischen den beiden und wie sie
interagieren. Du kannst bereits an dem zus&#xE4;tzlichen Scope, den wir mit
<code>{</code> und <code>}</code> eingef&#xFC;hrt haben, feststellen, dass etwas komisch ist.</p>
<p>Wenn wir sie entfernen, dann erhalten wir einen Fehler:</p>
<pre><code class="lang-text">error: cannot borrow `x` as immutable because it is also borrowed as mutable
    println!(&quot;{}&quot;, x);
                   ^
note: previous borrow of `x` occurs here; the mutable borrow prevents
subsequent moves, borrows, or modification of `x` until the borrow ends
        let y = &amp;mut x;
                     ^
note: previous borrow ends here
fn main() {

}
^
</code></pre>
<p>Wie es sich herausstellt gibt es Regeln.</p>
<h1 id="die-regeln"><a name="die-regeln" class="plugin-anchor" href="#die-regeln"><span class="fa fa-link"></span></a>Die Regeln</h1>
<p>Hier sind die Regeln die beim Ausleihen in Rust gelten:</p>
<p>Erstens darf etwas nicht l&#xE4;nger ausgeliehen werden als das ausgeliehene
existiert. Zweitens du darfst entweder die eine oder die andere Art von
Referenz haben, aber nicht beide zur gleichen Zeit:</p>
<ul>
<li>eine oder mehr Referenzen (<code>&amp;T</code>) auf eine Ressource,</li>
<li>genau eine ver&#xE4;nderbare Referenz (<code>&amp;mut T</code>).</li>
</ul>
<p>Du wirs feststellen, das dies sehr &#xE4;hnlich (wenn auch nicht ganz exakt)
der Definition eines <em>data race</em> entspricht:</p>
<blockquote>
<p>There is a &#x2018;data race&#x2019; when two or more pointers access the same memory
location at the same time, where at least one of them is writing, and the
operations are not synchronized.</p>
<p>Es gibt ein &#x2018;data race&#x2019;, wenn zwei oder mehr Zeiger zur selben Zeit
die gleiche Speicherstelle zugreifen, wobei mindestens ein Zugriff
schreibend erfolgt und die Operation nicht synchronisiert ist.</p>
</blockquote>
<p>Referenzen kann man so viele haben wie man m&#xF6;chte,
da keine von ihnen Schreibzugriffe erlaubt.
Wenn man schreibend zugreift, dann ben&#xF6;tigt es zwei oder
mehr Zeiger auf die gleiche Speicherstelle um einen <em>data race</em> hervorzurufen,
aber Rust erlaubt es uns zu einem gewissen Zeitpunkt nur eine <code>&amp;mut</code> Referenz
zu haben.
So verhindert Rust <em>data races</em> zur Kompilierzeit:
Wir erhalten Fehler, wenn wir die Regeln brechen.</p>
<h2 id="in-scopes-denken"><a name="in-scopes-denken" class="plugin-anchor" href="#in-scopes-denken"><span class="fa fa-link"></span></a>In Scopes denken</h2>
<p>Hier ist der Code:</p>
<pre><code class="lang-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> x = <span class="hljs-number">5</span>;
<span class="hljs-keyword">let</span> y = &amp;<span class="hljs-keyword">mut</span> x;

*y += <span class="hljs-number">1</span>;

<span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;{}&quot;</span>, x);
</code></pre>
<p>Dieser Code gibt uns diesen Fehler:</p>
<pre><code class="lang-text">error: cannot borrow `x` as immutable because it is also borrowed as mutable
    println!(&quot;{}&quot;, x);
                   ^
</code></pre>
<p>Das kommt weil wir die Regeln verletzt haben:
Wir haben ein <code>&amp;mut T</code> welches auf <code>x</code> zeigt, weswegen wir
keine  <code>&amp;T</code>s erzeugen d&#xFC;rfen. Entweder nur das eine oder nur das andere.
Die <code>note:</code> Meldung gibt uns einen Hinweis
wie man &#xFC;ber das Problem denken kann:</p>
<pre><code class="lang-text">note: previous borrow ends here
fn main() {

}
^
</code></pre>
<p>In anderen Worten bleibt das <em>mutable borrow</em> bis zum Ende unseres
Beispiels bestehen. Was wir wollen ist, dass das <em>mutable borrow</em>
endet <em>bevor</em> wir versuchen <code>println!</code> aufzurufen und damit eine
ein <em>immutable borrow</em> vornehmen.
In Rust ist ein <em>borrow</em> an den Scope gebunden f&#xFC;r den es g&#xFC;ltig ist.
Und unser Scope sieht so aus:</p>
<pre><code class="lang-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> x = <span class="hljs-number">5</span>;

<span class="hljs-keyword">let</span> y = &amp;<span class="hljs-keyword">mut</span> x;    <span class="hljs-comment">// -+ &amp;mut borrow of x starts here</span>
                   <span class="hljs-comment">//  |</span>
*y += <span class="hljs-number">1</span>;           <span class="hljs-comment">//  |</span>
                   <span class="hljs-comment">//  |</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;{}&quot;</span>, x); <span class="hljs-comment">// -+ - try to borrow x here</span>
                   <span class="hljs-comment">// -+ &amp;mut borrow of x ends here</span>
</code></pre>
<p>Die Scopes stehen im Konflikt: Wir k&#xF6;nnen kein <code>&amp;x</code> erzeugen, w&#xE4;hrend <code>y</code>
im Scope ist.
Wenn wir also geschweifte Klammern hinzuf&#xFC;gen:</p>
<pre><code class="lang-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> x = <span class="hljs-number">5</span>;

{                   
    <span class="hljs-keyword">let</span> y = &amp;<span class="hljs-keyword">mut</span> x; <span class="hljs-comment">// -+ &amp;mut borrow starts here</span>
    *y += <span class="hljs-number">1</span>;        <span class="hljs-comment">//  |</span>
}                   <span class="hljs-comment">// -+ ... and ends here</span>

<span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;{}&quot;</span>, x);  <span class="hljs-comment">// &lt;- try to borrow x here</span>
</code></pre>
<p>Dann gibt es kein Problem. Unser <em>mutable borrow</em> verl&#xE4;sst den Scope bevor
wir ein <em>immutable borrow</em> erzeugen.
Der Scope ist der Schl&#xFC;ssel um zu sehen wie lange ein <em>borrow</em> anh&#xE4;lt.</p>
<h2 id="probleme-die-das-ausleihen-verhindert"><a name="probleme-die-das-ausleihen-verhindert" class="plugin-anchor" href="#probleme-die-das-ausleihen-verhindert"><span class="fa fa-link"></span></a>Probleme die das Ausleihen verhindert</h2>
<p>Warum haben wir diese einschr&#xE4;nkenden Regeln?
Nun, wie wir schon angemerkt haben, verhindern sie <em>data rces</em>.
Welche Arten von Problemen werden durch <em>data races</em> erzeugt?
Hier sind ein paar.</p>
<h3 id="iterator-invalidation"><a name="iterator-invalidation" class="plugin-anchor" href="#iterator-invalidation"><span class="fa fa-link"></span></a>Iterator invalidation</h3>
<p>Ein Beispiel ist &#x2018;iterator invalidation&#x2019;,
welche stattfindet, wenn man versucht eine Collection
zu ver&#xE4;ndern &#xFC;ber die man iteriert. Rusts Borrow Checker verhindert,
dass das passiert:</p>
<pre><code class="lang-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> v = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &amp;v {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;{}&quot;</span>, i);
}
</code></pre>
<p>Dies gibt eins bis drei aus. W&#xE4;hrend wir durch den Vektor iterieren
erhalten wir nur Referenzen auf die Elemente. Und <code>v</code> ist selber
nur unver&#xE4;nderbar ausgeliehen, was bedeutet, dass wir es nicht
ver&#xE4;ndern k&#xF6;nnen, w&#xE4;hrend wir dar&#xFC;ber iterieren:</p>
<pre><code class="lang-rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> v = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &amp;v {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;{}&quot;</span>, i);
    v.push(<span class="hljs-number">34</span>);
}
</code></pre>
<p>Hier ist der Fehler:</p>
<pre><code class="lang-text">error: cannot borrow `v` as mutable because it is also borrowed as immutable
    v.push(34);
    ^
note: previous borrow of `v` occurs here; the immutable borrow prevents
subsequent moves or mutable borrows of `v` until the borrow ends
for i in &amp;v {
          ^
note: previous borrow ends here
for i in &amp;v {
    println!(&#x201C;{}&#x201D;, i);
    v.push(34);
}
^
</code></pre>
<p>Wir k&#xF6;nnen <code>v</code> nicht ver&#xE4;ndern, da es von der Schleife ausgeliehen ist.</p>
<h3 id="benutzung-nach-einem-free"><a name="benutzung-nach-einem-free" class="plugin-anchor" href="#benutzung-nach-einem-free"><span class="fa fa-link"></span></a>Benutzung nach einem <code>free</code></h3>
<p>Referenzen d&#xFC;rfen nicht l&#xE4;nger leben als die Ressource, die sie referenzieren.
Rust wird die Scopes deiner Referenzen &#xFC;berpr&#xFC;fen um sicherzustellen, dass
das gilt.</p>
<p>Wenn Rust diese Eigenschaft nicht pr&#xFC;fen w&#xFC;rde, dann k&#xF6;nnten wir
versehentlich eine ung&#xFC;ltige Referenz verwenden.
Zum Beispiel:</p>
<pre><code class="lang-rust"><span class="hljs-keyword">let</span> y: &amp;<span class="hljs-keyword">i32</span>;
{ 
    <span class="hljs-keyword">let</span> x = <span class="hljs-number">5</span>;
    y = &amp;x;
}

<span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;{}&quot;</span>, y);
</code></pre>
<p>Wir erhalten diesen Fehler:</p>
<pre><code class="lang-text">error: `x` does not live long enough
    y = &amp;x;
         ^
note: reference must be valid for the block suffix following statement 0 at
2:16...
let y: &amp;i32;
{ 
    let x = 5;
    y = &amp;x;
}

note: ...but borrowed value is only valid for the block suffix following
statement 0 at 4:18
    let x = 5;
    y = &amp;x;
}
</code></pre>
<p>In anderen Worten ist <code>y</code> nur f&#xFC;r das Scope g&#xFC;ltig, in dem <code>x</code> existiert.
Sobald <code>x</code> weggeht, ist es ung&#xFC;ltig darauf zu verweisen.
Deswegen sagt der Fehler dass das <em>borrow</em> nicht lange genug lebt
[<code>does not live long enough</code>], da es nicht f&#xFC;r die richtige L&#xE4;nge g&#xFC;ltig ist.</p>
<p>Dasselbe Problem taucht auf, wenn eine Referenz vor der referenzierten Variable
deklariert wird:</p>
<pre><code class="lang-rust"><span class="hljs-keyword">let</span> y: &amp;<span class="hljs-keyword">i32</span>;
<span class="hljs-keyword">let</span> x = <span class="hljs-number">5</span>;
y = &amp;x;

<span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;{}&quot;</span>, y);
</code></pre>
<p>Wir erhalten diesen Fehler:</p>
<pre><code class="lang-text">error: `x` does not live long enough
y = &amp;x;
     ^
note: reference must be valid for the block suffix following statement 0 at
2:16...
    let y: &amp;i32;
    let x = 5;
    y = &amp;x;

    println!(&quot;{}&quot;, y);
}

note: ...but borrowed value is only valid for the block suffix following
statement 1 at 3:14
    let x = 5;
    y = &amp;x;

    println!(&quot;{}&quot;, y);
}
</code></pre>
<p>In dem oberen Beispiel wird <code>y</code> vor <code>x</code> deklariert, was bedeutet, dass <code>y</code>
l&#xE4;nger lebt als <code>x</code>, was nicht erlaubt ist.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../book/Besitz.html" class="navigation navigation-prev " aria-label="Previous page: Besitz"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../book/Lebensdauer.html" class="navigation navigation-next " aria-label="Next page: Lebensdauer"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
